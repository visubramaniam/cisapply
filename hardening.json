{
  "metadata": {
    "hostname": "oel-cis-1216.coe.hv",
    "kernel": "5.15.0-205.149.5.1.el9uek.x86_64",
    "machine": "x86_64",
    "timestamp": "2025-12-19T06:38:13.987906",
    "cis_benchmark": "Oracle Linux 9 v2.0.0",
    "script_version": "2.0"
  },
  "profile": "l2-server",
  "dry_run": false,
  "execution": {
    "total_controls": 65,
    "passed": 64,
    "failed": 1,
    "compliance_percentage": 98.5
  },
  "remediation": {
    "remediated": 41,
    "already_compliant": 23,
    "failed": 1
  },
  "results": [
    {
      "id": "KERN-1",
      "title": "Disable uncommon filesystem/network kernel modules",
      "changed": true,
      "ok": true,
      "notes": "cramfs: No change; freevxfs: No change; hfs: No change; hfsplus: No change; jffs2: No change; squashfs: No change; udf: No change; usb-storage: No change; dccp: No change; sctp: No change; rds: No change; tipc: No change\n",
      "commands": [
        "modprobe -r cramfs",
        "modprobe -r freevxfs",
        "modprobe -r hfs",
        "modprobe -r hfsplus",
        "modprobe -r jffs2",
        "modprobe -r squashfs",
        "modprobe -r udf",
        "modprobe -r usb-storage",
        "modprobe -r dccp",
        "modprobe -r sctp",
        "modprobe -r rds",
        "modprobe -r tipc"
      ],
      "files": [
        "/etc/modprobe.d/cis-disable-cramfs.conf",
        "/etc/modprobe.d/cis-disable-freevxfs.conf",
        "/etc/modprobe.d/cis-disable-hfs.conf",
        "/etc/modprobe.d/cis-disable-hfsplus.conf",
        "/etc/modprobe.d/cis-disable-jffs2.conf",
        "/etc/modprobe.d/cis-disable-squashfs.conf",
        "/etc/modprobe.d/cis-disable-udf.conf",
        "/etc/modprobe.d/cis-disable-usb-storage.conf",
        "/etc/modprobe.d/cis-disable-dccp.conf",
        "/etc/modprobe.d/cis-disable-sctp.conf",
        "/etc/modprobe.d/cis-disable-rds.conf",
        "/etc/modprobe.d/cis-disable-tipc.conf"
      ],
      "cis_control": "1.1.1-1.1.24"
    },
    {
      "id": "SYSCTL-1",
      "title": "Apply CIS sysctl hardening",
      "changed": true,
      "ok": true,
      "notes": "* Applying /usr/lib/sysctl.d/01-unprivileged-bpf.conf ...\n* Applying /usr/lib/sysctl.d/10-default-yama-scope.conf ...\n* Applying /usr/lib/sysctl.d/50-coredump.conf ...\n* Applying /usr/lib/sysctl.d/50-default.conf ...\n* Applying /usr/lib/sysctl.d/50-libkcapi-optmem_max.conf ...\n* Applying /usr/lib/sysctl.d/50-pid-max.conf ...\n* Applying /usr/lib/sysctl.d/50-redhat.conf ...\n* Applying /etc/sysctl.d/99-cis-hardening.conf ...\n* Applying /etc/sysctl.d/99-sysctl.conf ...\n* Applying /etc/sysctl.conf ...\nkernel.unprivileged_bpf_disabled = 1\nkernel.yama.ptrace_scope = 0\nkernel.core_pattern = |/usr/lib/systemd/systemd-coredump %P %u %g %s %t %c %h %d %F\nkernel.core_pipe_limit = 16\nfs.suid_dumpable = 2\nkernel.sysrq = 16\nkernel.core_uses_pid = 1\nnet.ipv4.conf.default.rp_filter = 2\nnet.ipv4.conf.ens192.rp_filter = 2\nnet.ipv4.conf.lo.rp_filter = 2\nnet.ipv4.conf.default.accept_source_route = 0\nnet.ipv4.conf.ens192.accept_source_route = 0\nnet.ipv4.conf.lo.accept_source_route = 0\nnet.ipv4.conf.default.promote_secondaries = 1\nnet.ipv4.conf.ens192.promote_secondaries = 1\nnet.ipv4.conf.lo.promote_secondaries = 1\nnet.ipv4.ping_group_range = 0 2147483647\nnet.core.default_qdisc = fq_codel\nfs.protected_hardlinks = 1\nfs.protected_symlinks = 1\nfs.protected_regular = 1\nfs.protected_fifos = 1\nnet.core.optmem_max = 81920\nkernel.pid_max = 4194304\nkernel.kptr_restrict = 1\nnet.ipv4.conf.default.rp_filter = 1\nnet.ipv4.conf.ens192.rp_filter = 1\nnet.ipv4.conf.lo.rp_filter = 1\nfs.protected_hardlinks = 1\nfs.protected_symlinks = 1\nkernel.dmesg_restrict = 1\nkernel.kptr_restrict = 2\nkernel.randomize_va_space = 2\nkernel.yama.ptrace_scope = 1\nnet.ipv4.conf.all.accept_redirects = 0\nnet.ipv4.conf.all.accept_source_route = 0\nnet.ipv4.conf.all.log_martians = 1\nnet.ipv4.conf.all.rp_filter = 1\nnet.ipv4.conf.all.secure_redirects = 0\nnet.ipv4.conf.all.send_redirects = 0\nnet.ipv4.conf.default.accept_redirects = 0\nnet.ipv4.conf.default.accept_source_route = 0\nnet.ipv4.conf.default.log_martians = 1\nnet.ipv4.conf.default.rp_filter = 1\nnet.ipv4.conf.default.secure_redirects = 0\nnet.ipv4.conf.default.send_redirects = 0\nnet.ipv4.icmp_echo_ignore_broadcasts = 1\nnet.ipv4.icmp_ignore_bogus_error_responses = 1\nnet.ipv4.ip_forward = 0\nnet.ipv4.tcp_rfc1337 = 1\nnet.ipv4.tcp_syncookies = 1\nnet.ipv6.conf.all.accept_ra = 0\nnet.ipv6.conf.all.accept_redirects = 0\nnet.ipv6.conf.default.accept_ra = 0\nnet.ipv6.conf.default.accept_redirects = 0",
      "commands": [
        "bash -lc 'cat > /etc/sysctl.d/99-cis-hardening.conf <<'\"'\"'EOF'\"'\"'\n# Generated by cis hardening scripts\nfs.protected_hardlinks = 1\nfs.protected_symlinks = 1\nkernel.dmesg_restrict = 1\nkernel.kptr_restrict = 2\nkernel.randomize_va_space = 2\nkernel.yama.ptrace_scope = 1\nnet.ipv4.conf.all.accept_redirects = 0\nnet.ipv4.conf.all.accept_source_route = 0\nnet.ipv4.conf.all.log_martians = 1\nnet.ipv4.conf.all.rp_filter = 1\nnet.ipv4.conf.all.secure_redirects = 0\nnet.ipv4.conf.all.send_redirects = 0\nnet.ipv4.conf.default.accept_redirects = 0\nnet.ipv4.conf.default.accept_source_route = 0\nnet.ipv4.conf.default.log_martians = 1\nnet.ipv4.conf.default.rp_filter = 1\nnet.ipv4.conf.default.secure_redirects = 0\nnet.ipv4.conf.default.send_redirects = 0\nnet.ipv4.icmp_echo_ignore_broadcasts = 1\nnet.ipv4.icmp_ignore_bogus_error_responses = 1\nnet.ipv4.ip_forward = 0\nnet.ipv4.tcp_rfc1337 = 1\nnet.ipv4.tcp_syncookies = 1\nnet.ipv6.conf.all.accept_ra = 0\nnet.ipv6.conf.all.accept_redirects = 0\nnet.ipv6.conf.default.accept_ra = 0\nnet.ipv6.conf.default.accept_redirects = 0\nEOF\nchmod 644 /etc/sysctl.d/99-cis-hardening.conf'",
        "sysctl --system"
      ],
      "files": [
        "/etc/sysctl.d/99-cis-hardening.conf"
      ],
      "cis_control": "3.1.1-3.3.2"
    },
    {
      "id": "CRYPTO-1",
      "title": "Ensure system crypto policy is not LEGACY",
      "changed": false,
      "ok": true,
      "notes": "current: DEFAULT",
      "commands": [
        "update-crypto-policies --show",
        "update-crypto-policies --set DEFAULT"
      ],
      "files": null,
      "cis_control": "1.5.1"
    },
    {
      "id": "BANNER-1",
      "title": "Set login banners and clear /etc/motd",
      "changed": false,
      "ok": true,
      "notes": "No change; No change; No change",
      "commands": null,
      "files": [
        "/etc/issue",
        "/etc/issue.net",
        "/etc/motd"
      ],
      "cis_control": "5.4.4"
    },
    {
      "id": "SSH-1",
      "title": "Harden SSH daemon configuration",
      "changed": false,
      "ok": true,
      "notes": "",
      "commands": [
        "bash -lc 'mkdir -p /etc/ssh/sshd_config.d && cat > /etc/ssh/sshd_config.d/99-cis-hardening.conf <<'\"'\"'EOF'\"'\"'\n# Generated by cis hardening scripts\nPermitRootLogin no\nPasswordAuthentication no\nX11Forwarding no\nMaxAuthTries 4\nLoginGraceTime 60\nClientAliveInterval 300\nClientAliveCountMax 0\nAllowTcpForwarding no\nAllowAgentForwarding no\nUsePAM yes\nPermitEmptyPasswords no\nIgnoreRhosts yes\nHostbasedAuthentication no\nPermitUserEnvironment no\nLogLevel INFO\nEOF\nchmod 600 /etc/ssh/sshd_config.d/99-cis-hardening.conf'",
        "sshd -t",
        "systemctl restart sshd"
      ],
      "files": [
        "/etc/ssh/sshd_config.d/99-cis-hardening.conf"
      ],
      "cis_control": "5.2.1-5.2.21"
    },
    {
      "id": "SUDO-1",
      "title": "Configure sudo to use pty and log to /var/log/sudo.log",
      "changed": false,
      "ok": true,
      "notes": "No change",
      "commands": null,
      "files": [
        "/etc/sudoers.d/99-cis-hardening"
      ],
      "cis_control": "5.3.7"
    },
    {
      "id": "SVC-avahi-daemon",
      "title": "Disable service: avahi-daemon",
      "changed": true,
      "ok": true,
      "notes": "",
      "commands": [
        "systemctl mask --now avahi-daemon"
      ],
      "files": null,
      "cis_control": "2.1.1"
    },
    {
      "id": "SVC-cups",
      "title": "Disable service: cups",
      "changed": true,
      "ok": true,
      "notes": "",
      "commands": [
        "systemctl mask --now cups"
      ],
      "files": null,
      "cis_control": "2.2.1"
    },
    {
      "id": "SVC-dhcpd",
      "title": "Disable service: dhcpd",
      "changed": true,
      "ok": true,
      "notes": "",
      "commands": [
        "systemctl mask --now dhcpd"
      ],
      "files": null,
      "cis_control": "2.1.2"
    },
    {
      "id": "SVC-slapd",
      "title": "Disable service: slapd",
      "changed": true,
      "ok": true,
      "notes": "",
      "commands": [
        "systemctl mask --now slapd"
      ],
      "files": null,
      "cis_control": "2.1.3"
    },
    {
      "id": "SVC-nfs-server",
      "title": "Disable service: nfs-server",
      "changed": true,
      "ok": true,
      "notes": "",
      "commands": [
        "systemctl mask --now nfs-server"
      ],
      "files": null,
      "cis_control": "2.1.4"
    },
    {
      "id": "SVC-rpcbind",
      "title": "Disable service: rpcbind",
      "changed": true,
      "ok": true,
      "notes": "",
      "commands": [
        "systemctl mask --now rpcbind"
      ],
      "files": null,
      "cis_control": "2.1.5"
    },
    {
      "id": "SVC-smb",
      "title": "Disable service: smb",
      "changed": true,
      "ok": true,
      "notes": "",
      "commands": [
        "systemctl mask --now smb"
      ],
      "files": null,
      "cis_control": "2.2.2"
    },
    {
      "id": "SVC-snmpd",
      "title": "Disable service: snmpd",
      "changed": true,
      "ok": true,
      "notes": "",
      "commands": [
        "systemctl mask --now snmpd"
      ],
      "files": null,
      "cis_control": "2.2.3"
    },
    {
      "id": "SVC-rsyncd",
      "title": "Disable service: rsyncd",
      "changed": true,
      "ok": true,
      "notes": "",
      "commands": [
        "systemctl mask --now rsyncd"
      ],
      "files": null,
      "cis_control": "2.2.4"
    },
    {
      "id": "SVC-ypserv",
      "title": "Disable service: ypserv",
      "changed": true,
      "ok": true,
      "notes": "",
      "commands": [
        "systemctl mask --now ypserv"
      ],
      "files": null,
      "cis_control": "2.1.6"
    },
    {
      "id": "SVC-telnet.socket",
      "title": "Disable service: telnet.socket",
      "changed": true,
      "ok": true,
      "notes": "",
      "commands": [
        "systemctl mask --now telnet.socket"
      ],
      "files": null,
      "cis_control": "2.3.1"
    },
    {
      "id": "SVC-tftp.socket",
      "title": "Disable service: tftp.socket",
      "changed": true,
      "ok": true,
      "notes": "",
      "commands": [
        "systemctl mask --now tftp.socket"
      ],
      "files": null,
      "cis_control": "2.3.2"
    },
    {
      "id": "SVC-systemd-journal-remote.service",
      "title": "Disable service: systemd-journal-remote.service",
      "changed": true,
      "ok": true,
      "notes": "",
      "commands": [
        "systemctl mask --now systemd-journal-remote.service"
      ],
      "files": null
    },
    {
      "id": "SVC-systemd-journal-upload.service",
      "title": "Disable service: systemd-journal-upload.service",
      "changed": true,
      "ok": true,
      "notes": "",
      "commands": [
        "systemctl mask --now systemd-journal-upload.service"
      ],
      "files": null
    },
    {
      "id": "SVC-AIDE-PKG",
      "title": "Ensure aide package is installed",
      "changed": true,
      "ok": true,
      "notes": "Last metadata expiration check: 1:30:08 ago on Fri 19 Dec 2025 05:08:11 AM CST.\nPackage aide-0.16-105.el9.x86_64 is already installed.\nDependencies resolved.\nNothing to do.\nComplete!",
      "commands": [
        "dnf -y install aide"
      ],
      "files": null
    },
    {
      "id": "SVC-AIDE-INIT",
      "title": "Ensure AIDE database is initialized",
      "changed": false,
      "ok": false,
      "notes": "Failed to initialize AIDE database: 0:syntax error:/\n0:Error while reading configuration:/\nConfiguration error\n",
      "commands": [
        "aide --init -B database_in=/var/lib/aide/aide.db"
      ],
      "files": []
    },
    {
      "id": "SVC-aidecheck.service",
      "title": "Enable AIDE file integrity monitoring service",
      "changed": false,
      "ok": true,
      "notes": "aidecheck.service not available on this system",
      "commands": [],
      "files": []
    },
    {
      "id": "SVC-aidecheck.timer",
      "title": "Enable AIDE file integrity monitoring timer",
      "changed": false,
      "ok": true,
      "notes": "aidecheck.timer not available on this system",
      "commands": [],
      "files": []
    },
    {
      "id": "SVC-auditd",
      "title": "Enable Audit daemon for security logging",
      "changed": true,
      "ok": true,
      "notes": "",
      "commands": [
        "systemctl enable --now auditd"
      ],
      "files": null
    },
    {
      "id": "SVC-JOURNAL-REMOTE",
      "title": "Ensure systemd-journal-remote is disabled",
      "changed": false,
      "ok": true,
      "notes": "systemd-journal-remote.service already disabled",
      "commands": [],
      "files": []
    },
    {
      "id": "PKG-1",
      "title": "Remove legacy/insecure network packages",
      "changed": true,
      "ok": true,
      "notes": "No match for argument: telnet\nNo match for argument: telnet-server\nNo match for argument: ftp\nNo match for argument: tftp\nNo match for argument: tftp-server\nNo match for argument: rsh\nNo match for argument: rsh-server\nNo match for argument: ypbind\nNo match for argument: ypserv\nNo match for argument: talk\nNo match for argument: talk-server\nNo match for argument: xinetd\nDependencies resolved.\nNothing to do.\nComplete!\nNo packages marked for removal.",
      "commands": [
        "dnf -y remove telnet telnet-server ftp tftp tftp-server rsh rsh-server ypbind ypserv talk talk-server xinetd"
      ],
      "files": null,
      "cis_control": "2.4.1-2.4.2"
    },
    {
      "id": "AUD-1",
      "title": "Install auditd and aide packages",
      "changed": true,
      "ok": true,
      "notes": "Last metadata expiration check: 1:30:12 ago on Fri 19 Dec 2025 05:08:11 AM CST.\nPackage audit-3.1.5-7.0.1.el9.x86_64 is already installed.\nPackage audit-libs-3.1.5-7.0.1.el9.x86_64 is already installed.\nPackage aide-0.16-105.el9.x86_64 is already installed.\nDependencies resolved.\nNothing to do.\nComplete!",
      "commands": [
        "dnf -y install audit audit-libs aide"
      ],
      "files": null,
      "cis_control": "4.1.1"
    },
    {
      "id": "AUD-2",
      "title": "Enable auditd service",
      "changed": true,
      "ok": true,
      "notes": "",
      "commands": [
        "systemctl enable --now auditd"
      ],
      "files": null,
      "cis_control": "4.1.2"
    },
    {
      "id": "AUD-2a",
      "title": "Configure auditd settings",
      "changed": false,
      "ok": true,
      "notes": "No change; No change; No change",
      "commands": null,
      "files": [
        "/etc/audit/auditd.conf"
      ]
    },
    {
      "id": "AUD-3",
      "title": "Install CIS audit rules and load",
      "changed": false,
      "ok": true,
      "notes": "No change\n/sbin/augenrules: Audit system is in immutable mode - exiting with no changes",
      "commands": [
        "augenrules --load"
      ],
      "files": [
        "/etc/audit/rules.d/99-cis-hardening.rules"
      ],
      "cis_control": "4.1.3-4.1.18"
    },
    {
      "id": "LOG-1",
      "title": "Harden journald persistence/limits/forwarding",
      "changed": false,
      "ok": true,
      "notes": "No change; No change; No change; No change",
      "commands": null,
      "files": [
        "/etc/systemd/journald.conf"
      ],
      "cis_control": "4.2.2.1"
    },
    {
      "id": "LOG-2",
      "title": "Install rsyslog",
      "changed": true,
      "ok": true,
      "notes": "Last metadata expiration check: 1:30:15 ago on Fri 19 Dec 2025 05:08:11 AM CST.\nPackage rsyslog-8.2506.0-2.0.1.el9.x86_64 is already installed.\nDependencies resolved.\nNothing to do.\nComplete!",
      "commands": [
        "dnf -y install rsyslog"
      ],
      "files": null,
      "cis_control": "4.2.1.1"
    },
    {
      "id": "LOG-3",
      "title": "Configure rsyslog $FileCreateMode",
      "changed": false,
      "ok": true,
      "notes": "No change",
      "commands": null,
      "files": [
        "/etc/rsyslog.conf"
      ],
      "cis_control": "4.2.1.2"
    },
    {
      "id": "LOG-4",
      "title": "Enable rsyslog service",
      "changed": true,
      "ok": true,
      "notes": "",
      "commands": [
        "systemctl enable --now rsyslog"
      ],
      "files": null
    },
    {
      "id": "LOG-5",
      "title": "Enable systemd-journald service",
      "changed": true,
      "ok": true,
      "notes": "The unit files have no installation config (WantedBy=, RequiredBy=, Also=,\nAlias= settings in the [Install] section, and DefaultInstance= for template\nunits). This means they are not meant to be enabled or disabled using systemctl.\n \nPossible reasons for having this kind of units are:\n\u2022 A unit may be statically enabled by being symlinked from another unit's\n  .wants/ or .requires/ directory.\n\u2022 A unit's purpose may be to act as a helper for some other unit which has\n  a requirement dependency on it.\n\u2022 A unit may be started when needed via activation (socket, path, timer,\n  D-Bus, udev, scripted systemctl call, ...).\n\u2022 In case of template units, the unit is meant to be enabled with some\n  instance name specified.",
      "commands": [
        "systemctl enable --now systemd-journald"
      ],
      "files": null
    },
    {
      "id": "LOG-6-/var/log/wtmp",
      "title": "Set permissions on /var/log/wtmp",
      "changed": true,
      "ok": true,
      "notes": "Set /var/log/wtmp owner 0:22->0:0",
      "commands": null,
      "files": [
        "/var/log/wtmp"
      ]
    },
    {
      "id": "LOG-6-/var/log/btmp",
      "title": "Set permissions on /var/log/btmp",
      "changed": true,
      "ok": true,
      "notes": "Set /var/log/btmp owner 0:22->0:0",
      "commands": null,
      "files": [
        "/var/log/btmp"
      ]
    },
    {
      "id": "LOG-6-/var/log/lastlog",
      "title": "Set permissions on /var/log/lastlog",
      "changed": true,
      "ok": true,
      "notes": "Set /var/log/lastlog mode 0o664->0o644, owner 0:22->0:0",
      "commands": null,
      "files": [
        "/var/log/lastlog"
      ]
    },
    {
      "id": "LOG-7-/var/log/messages",
      "title": "Set permissions on /var/log/messages",
      "changed": false,
      "ok": true,
      "notes": "No change",
      "commands": null,
      "files": [
        "/var/log/messages"
      ]
    },
    {
      "id": "LOG-7-/var/log/secure",
      "title": "Set permissions on /var/log/secure",
      "changed": false,
      "ok": true,
      "notes": "No change",
      "commands": null,
      "files": [
        "/var/log/secure"
      ]
    },
    {
      "id": "LOG-9",
      "title": "Install systemd-journal-remote",
      "changed": true,
      "ok": true,
      "notes": "Last metadata expiration check: 1:30:19 ago on Fri 19 Dec 2025 05:08:11 AM CST.\nPackage systemd-journal-remote-252-55.0.3.el9_7.7.x86_64 is already installed.\nDependencies resolved.\nNothing to do.\nComplete!",
      "commands": [
        "dnf -y install systemd-journal-remote"
      ],
      "files": null
    },
    {
      "id": "LOG-10",
      "title": "Disable systemd-journal-remote",
      "changed": true,
      "ok": true,
      "notes": "Unit /etc/systemd/system/systemd-journal-remote.service is masked, ignoring.\nThe unit files have no installation config (WantedBy=, RequiredBy=, Also=,\nAlias= settings in the [Install] section, and DefaultInstance= for template\nunits). This means they are not meant to be enabled or disabled using systemctl.\n \nPossible reasons for having this kind of units are:\n\u2022 A unit may be statically enabled by being symlinked from another unit's\n  .wants/ or .requires/ directory.\n\u2022 A unit's purpose may be to act as a helper for some other unit which has\n  a requirement dependency on it.\n\u2022 A unit may be started when needed via activation (socket, path, timer,\n  D-Bus, udev, scripted systemctl call, ...).\n\u2022 In case of template units, the unit is meant to be enabled with some\n  instance name specified.",
      "commands": [
        "systemctl disable --now systemd-journal-remote"
      ],
      "files": null
    },
    {
      "id": "LOG-11",
      "title": "Disable systemd-journal-upload",
      "changed": true,
      "ok": true,
      "notes": "Unit /etc/systemd/system/systemd-journal-upload.service is masked, ignoring.\nThe unit files have no installation config (WantedBy=, RequiredBy=, Also=,\nAlias= settings in the [Install] section, and DefaultInstance= for template\nunits). This means they are not meant to be enabled or disabled using systemctl.\n \nPossible reasons for having this kind of units are:\n\u2022 A unit may be statically enabled by being symlinked from another unit's\n  .wants/ or .requires/ directory.\n\u2022 A unit's purpose may be to act as a helper for some other unit which has\n  a requirement dependency on it.\n\u2022 A unit may be started when needed via activation (socket, path, timer,\n  D-Bus, udev, scripted systemctl call, ...).\n\u2022 In case of template units, the unit is meant to be enabled with some\n  instance name specified.",
      "commands": [
        "systemctl disable --now systemd-journal-upload"
      ],
      "files": null
    },
    {
      "id": "PERM-1",
      "title": "Harden key system file permissions",
      "changed": false,
      "ok": true,
      "notes": "/etc/passwd: No change; /etc/group: No change; /etc/shadow: No change; /etc/gshadow: No change; /etc/ssh/sshd_config: No change",
      "commands": null,
      "files": null,
      "cis_control": "5.6.1-5.6.5"
    },
    {
      "id": "FW-1",
      "title": "Install firewalld",
      "changed": true,
      "ok": true,
      "notes": "Last metadata expiration check: 1:30:22 ago on Fri 19 Dec 2025 05:08:11 AM CST.\nPackage firewalld-1.3.4-15.0.1.el9_6.noarch is already installed.\nDependencies resolved.\nNothing to do.\nComplete!",
      "commands": [
        "dnf -y install firewalld"
      ],
      "files": null,
      "cis_control": "3.4.1"
    },
    {
      "id": "FW-2",
      "title": "Enable firewalld",
      "changed": true,
      "ok": true,
      "notes": "",
      "commands": [
        "systemctl enable --now firewalld"
      ],
      "files": null,
      "cis_control": "3.4.2"
    },
    {
      "id": "FW-3",
      "title": "Configure firewalld",
      "changed": true,
      "ok": true,
      "notes": "success\nWarning: ZONE_ALREADY_SET: public\nsuccess\nsuccess\nsuccess\nsuccess\nsuccess",
      "commands": [
        "firewall-cmd --set-default-zone public",
        "bash -lc 'set -e\nZONE=public\nSVCS=\"$(firewall-cmd --zone=\"$ZONE\" --list-services || true)\"\nPORTS=\"$(firewall-cmd --zone=\"$ZONE\" --list-ports || true)\"\nfor s in $SVCS; do firewall-cmd --permanent --zone=\"$ZONE\" --remove-service=\"$s\" || true; done\nfor p in $PORTS; do firewall-cmd --permanent --zone=\"$ZONE\" --remove-port=\"$p\" || true; done\nfirewall-cmd --permanent --zone=\"$ZONE\" --add-service=ssh\nfirewall-cmd --permanent --zone=\"$ZONE\" --add-service=https\nfirewall-cmd --reload'"
      ],
      "files": null,
      "cis_control": "3.4.3-3.4.4"
    },
    {
      "id": "SEL-1",
      "title": "Ensure SELinux is enforcing",
      "changed": true,
      "ok": true,
      "notes": "Enforcing",
      "commands": [
        "getenforce",
        "bash -lc 'sed -ri '\"'\"'s/^SELINUX=.*/SELINUX=enforcing/'\"'\"' /etc/selinux/config'",
        "setenforce 1"
      ],
      "files": [
        "/etc/selinux/config"
      ],
      "cis_control": "1.6.1"
    },
    {
      "id": "AUTH-0",
      "title": "Install authentication packages",
      "changed": true,
      "ok": true,
      "notes": "Last metadata expiration check: 1:30:29 ago on Fri 19 Dec 2025 05:08:11 AM CST.\nPackage authselect-1.2.6-3.el9.x86_64 is already installed.\nPackage libpwquality-1.4.4-8.el9.x86_64 is already installed.\nPackage pam-1.5.1-26.0.1.el9_6.x86_64 is already installed.\nDependencies resolved.\nNothing to do.\nComplete!",
      "commands": [
        "dnf -y install authselect libpwquality pam"
      ],
      "files": null
    },
    {
      "id": "AUTH-1",
      "title": "Configure password quality (pwquality.conf)",
      "changed": false,
      "ok": true,
      "notes": "No change; No change; No change; No change; No change; No change; No change; No change; No change; No change",
      "commands": null,
      "files": [
        "/etc/security/pwquality.conf"
      ],
      "cis_control": "5.4.1"
    },
    {
      "id": "AUTH-1b",
      "title": "Configure password history (pwhistory.conf)",
      "changed": false,
      "ok": true,
      "notes": "No change; No change",
      "commands": null,
      "files": [
        "/etc/security/pwhistory.conf"
      ]
    },
    {
      "id": "AUTH-2",
      "title": "Configure password aging (login.defs)",
      "changed": false,
      "ok": true,
      "notes": "No change; No change; No change",
      "commands": null,
      "files": [
        "/etc/login.defs"
      ],
      "cis_control": "5.4.2"
    },
    {
      "id": "AUTH-3",
      "title": "Set default umask",
      "changed": true,
      "ok": true,
      "notes": "",
      "commands": [
        "bash -lc 'cat > /etc/profile.d/99-cis-umask.sh <<'\"'\"'EOF'\"'\"'\numask 027\nEOF\nchmod 644 /etc/profile.d/99-cis-umask.sh'"
      ],
      "files": [
        "/etc/profile.d/99-cis-umask.sh"
      ],
      "cis_control": "5.4.5"
    },
    {
      "id": "AUTH-3a-/etc/bashrc",
      "title": "Set session timeout in /etc/bashrc",
      "changed": false,
      "ok": true,
      "notes": "No change",
      "commands": null,
      "files": [
        "/etc/bashrc"
      ]
    },
    {
      "id": "AUTH-3a-/etc/profile",
      "title": "Set session timeout in /etc/profile",
      "changed": false,
      "ok": true,
      "notes": "No change",
      "commands": null,
      "files": [
        "/etc/profile"
      ]
    },
    {
      "id": "AUTH-4",
      "title": "Enable/configure account lockout (faillock)",
      "changed": true,
      "ok": true,
      "notes": "[error] [/etc/authselect/system-auth] has unexpected content!\n[error] [/etc/authselect/password-auth] has unexpected content!\n[error] Unexpected changes to the configuration were detected.\n[error] Refusing to activate profile unless those changes are removed or overwrite is requested.\nUnable to enable feature [17]: File exists; No change; No change; No change; No change",
      "commands": [
        "bash -lc 'authselect current >/dev/null 2>&1 && authselect enable-feature with-faillock && authselect apply-changes || true'"
      ],
      "files": [
        "/etc/security/faillock.conf"
      ],
      "cis_control": "5.4.6"
    },
    {
      "id": "CORE-1",
      "title": "Disable core dumps",
      "changed": true,
      "ok": true,
      "notes": "; Updated /etc/sysctl.d/99-cis-hardening.conf: fs.suid_dumpable",
      "commands": [
        "bash -lc 'cat > /etc/security/limits.d/99-cis-coredumps.conf <<'\"'\"'EOF'\"'\"'\n* hard core 0\nEOF\nchmod 644 /etc/security/limits.d/99-cis-coredumps.conf'"
      ],
      "files": [
        "/etc/security/limits.d/99-cis-coredumps.conf"
      ],
      "cis_control": "1.5.3"
    },
    {
      "id": "CRON-1",
      "title": "Enable cron daemon",
      "changed": true,
      "ok": true,
      "notes": "",
      "commands": [
        "systemctl enable --now crond"
      ],
      "files": null,
      "cis_control": "5.1.1"
    },
    {
      "id": "CRON-2",
      "title": "Restrict cron/at to authorized users",
      "changed": false,
      "ok": true,
      "notes": "No change; No change",
      "commands": null,
      "files": [
        "/etc/cron.allow",
        "/etc/at.allow"
      ],
      "cis_control": "5.1.2"
    },
    {
      "id": "CRON-3",
      "title": "Harden cron permissions",
      "changed": false,
      "ok": true,
      "notes": "/etc/crontab: No change; /etc/cron.hourly: No change; /etc/cron.daily: No change; /etc/cron.weekly: No change; /etc/cron.monthly: No change; /etc/cron.d: No change",
      "commands": null,
      "files": null,
      "cis_control": "5.1.3-5.1.5"
    },
    {
      "id": "AIDE-1",
      "title": "Install AIDE",
      "changed": true,
      "ok": true,
      "notes": "Last metadata expiration check: 1:30:32 ago on Fri 19 Dec 2025 05:08:11 AM CST.\nPackage aide-0.16-105.el9.x86_64 is already installed.\nDependencies resolved.\nNothing to do.\nComplete!",
      "commands": [
        "dnf -y install aide"
      ],
      "files": null,
      "cis_control": "6.2.1"
    },
    {
      "id": "AIDE-2",
      "title": "AIDE initialization (skipped by config)",
      "changed": false,
      "ok": true,
      "notes": "Set aide.initialize_if_missing=true to initialize",
      "commands": null,
      "files": null,
      "cis_control": "6.2.1"
    },
    {
      "id": "MNT-1",
      "title": "Configure tmpfs mounts for /tmp and /var/tmp",
      "changed": true,
      "ok": true,
      "notes": "",
      "commands": [
        "bash -lc 'cat > /etc/systemd/system/tmp.mount <<'\"'\"'EOF'\"'\"'\n[Unit]\nDescription=Temporary Directory (/tmp)\nBefore=local-fs.target\n\n[Mount]\nWhat=tmpfs\nWhere=/tmp\nType=tmpfs\nOptions=mode=1777,strictatime,nodev,nosuid,noexec,size=1G\n\n[Install]\nWantedBy=local-fs.target\nEOF\ncat > /etc/systemd/system/var-tmp.mount <<'\"'\"'EOF'\"'\"'\n[Unit]\nDescription=Temporary Directory (/var/tmp)\nBefore=local-fs.target\n\n[Mount]\nWhat=tmpfs\nWhere=/var/tmp\nType=tmpfs\nOptions=mode=1777,strictatime,nodev,nosuid,noexec,size=1G\n\n[Install]\nWantedBy=local-fs.target\nEOF\nsystemctl daemon-reload\nsystemctl enable --now tmp.mount var-tmp.mount'"
      ],
      "files": [
        "/etc/systemd/system/tmp.mount",
        "/etc/systemd/system/var-tmp.mount"
      ],
      "cis_control": "1.4.2"
    },
    {
      "id": "IPV6-0",
      "title": "Disable IPv6 (skipped by config)",
      "changed": false,
      "ok": true,
      "notes": "ipv6.disable=false",
      "commands": null,
      "files": null,
      "cis_control": "3.3.1-3.3.2"
    }
  ],
  "ok": false
}