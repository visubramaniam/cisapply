{
  "profile": "l2-server",
  "dry_run": false,
  "host": "oel-cis-1216.coe.hv",
  "results": [
    {
      "id": "KERN-1",
      "title": "Disable uncommon filesystem/network kernel modules",
      "changed": true,
      "ok": true,
      "notes": "cramfs: Wrote /etc/modprobe.d/cis-disable-cramfs.conf; freevxfs: Wrote /etc/modprobe.d/cis-disable-freevxfs.conf; hfs: Wrote /etc/modprobe.d/cis-disable-hfs.conf; hfsplus: Wrote /etc/modprobe.d/cis-disable-hfsplus.conf; jffs2: Wrote /etc/modprobe.d/cis-disable-jffs2.conf; squashfs: Wrote /etc/modprobe.d/cis-disable-squashfs.conf; udf: Wrote /etc/modprobe.d/cis-disable-udf.conf; usb-storage: Wrote /etc/modprobe.d/cis-disable-usb-storage.conf; dccp: Wrote /etc/modprobe.d/cis-disable-dccp.conf; sctp: Wrote /etc/modprobe.d/cis-disable-sctp.conf; rds: Wrote /etc/modprobe.d/cis-disable-rds.conf; tipc: Wrote /etc/modprobe.d/cis-disable-tipc.conf\n",
      "commands": [
        "modprobe -r cramfs",
        "modprobe -r freevxfs",
        "modprobe -r hfs",
        "modprobe -r hfsplus",
        "modprobe -r jffs2",
        "modprobe -r squashfs",
        "modprobe -r udf",
        "modprobe -r usb-storage",
        "modprobe -r dccp",
        "modprobe -r sctp",
        "modprobe -r rds",
        "modprobe -r tipc"
      ],
      "files": [
        "/etc/modprobe.d/cis-disable-cramfs.conf",
        "/etc/modprobe.d/cis-disable-freevxfs.conf",
        "/etc/modprobe.d/cis-disable-hfs.conf",
        "/etc/modprobe.d/cis-disable-hfsplus.conf",
        "/etc/modprobe.d/cis-disable-jffs2.conf",
        "/etc/modprobe.d/cis-disable-squashfs.conf",
        "/etc/modprobe.d/cis-disable-udf.conf",
        "/etc/modprobe.d/cis-disable-usb-storage.conf",
        "/etc/modprobe.d/cis-disable-dccp.conf",
        "/etc/modprobe.d/cis-disable-sctp.conf",
        "/etc/modprobe.d/cis-disable-rds.conf",
        "/etc/modprobe.d/cis-disable-tipc.conf"
      ]
    },
    {
      "id": "SYSCTL-1",
      "title": "Apply CIS sysctl hardening",
      "changed": true,
      "ok": true,
      "notes": "* Applying /usr/lib/sysctl.d/01-unprivileged-bpf.conf ...\n* Applying /usr/lib/sysctl.d/10-default-yama-scope.conf ...\n* Applying /usr/lib/sysctl.d/50-coredump.conf ...\n* Applying /usr/lib/sysctl.d/50-default.conf ...\n* Applying /usr/lib/sysctl.d/50-libkcapi-optmem_max.conf ...\n* Applying /usr/lib/sysctl.d/50-pid-max.conf ...\n* Applying /usr/lib/sysctl.d/50-redhat.conf ...\n* Applying /etc/sysctl.d/99-cis-hardening.conf ...\n* Applying /etc/sysctl.d/99-sysctl.conf ...\n* Applying /etc/sysctl.conf ...\nkernel.unprivileged_bpf_disabled = 1\nkernel.yama.ptrace_scope = 0\nkernel.core_pattern = |/usr/lib/systemd/systemd-coredump %P %u %g %s %t %c %h\nkernel.core_pipe_limit = 16\nfs.suid_dumpable = 2\nkernel.sysrq = 16\nkernel.core_uses_pid = 1\nnet.ipv4.conf.default.rp_filter = 2\nnet.ipv4.conf.ens192.rp_filter = 2\nnet.ipv4.conf.lo.rp_filter = 2\nnet.ipv4.conf.default.accept_source_route = 0\nnet.ipv4.conf.ens192.accept_source_route = 0\nnet.ipv4.conf.lo.accept_source_route = 0\nnet.ipv4.conf.default.promote_secondaries = 1\nnet.ipv4.conf.ens192.promote_secondaries = 1\nnet.ipv4.conf.lo.promote_secondaries = 1\nnet.ipv4.ping_group_range = 0 2147483647\nnet.core.default_qdisc = fq_codel\nfs.protected_hardlinks = 1\nfs.protected_symlinks = 1\nfs.protected_regular = 1\nfs.protected_fifos = 1\nnet.core.optmem_max = 81920\nkernel.pid_max = 4194304\nkernel.kptr_restrict = 1\nnet.ipv4.conf.default.rp_filter = 1\nnet.ipv4.conf.ens192.rp_filter = 1\nnet.ipv4.conf.lo.rp_filter = 1\nfs.protected_hardlinks = 1\nfs.protected_symlinks = 1\nkernel.dmesg_restrict = 1\nkernel.kptr_restrict = 2\nkernel.randomize_va_space = 2\nkernel.yama.ptrace_scope = 1\nnet.ipv4.conf.all.accept_redirects = 0\nnet.ipv4.conf.all.accept_source_route = 0\nnet.ipv4.conf.all.log_martians = 1\nnet.ipv4.conf.all.rp_filter = 1\nnet.ipv4.conf.all.secure_redirects = 0\nnet.ipv4.conf.all.send_redirects = 0\nnet.ipv4.conf.default.accept_redirects = 0\nnet.ipv4.conf.default.accept_source_route = 0\nnet.ipv4.conf.default.log_martians = 1\nnet.ipv4.conf.default.rp_filter = 1\nnet.ipv4.conf.default.secure_redirects = 0\nnet.ipv4.conf.default.send_redirects = 0\nnet.ipv4.icmp_echo_ignore_broadcasts = 1\nnet.ipv4.icmp_ignore_bogus_error_responses = 1\nnet.ipv4.ip_forward = 0\nnet.ipv4.tcp_rfc1337 = 1\nnet.ipv4.tcp_syncookies = 1\nnet.ipv6.conf.all.accept_ra = 0\nnet.ipv6.conf.all.accept_redirects = 0\nnet.ipv6.conf.default.accept_ra = 0\nnet.ipv6.conf.default.accept_redirects = 0",
      "commands": [
        "bash -lc 'cat > /etc/sysctl.d/99-cis-hardening.conf <<'\"'\"'EOF'\"'\"'\n# Generated by cis hardening scripts\nfs.protected_hardlinks = 1\nfs.protected_symlinks = 1\nkernel.dmesg_restrict = 1\nkernel.kptr_restrict = 2\nkernel.randomize_va_space = 2\nkernel.yama.ptrace_scope = 1\nnet.ipv4.conf.all.accept_redirects = 0\nnet.ipv4.conf.all.accept_source_route = 0\nnet.ipv4.conf.all.log_martians = 1\nnet.ipv4.conf.all.rp_filter = 1\nnet.ipv4.conf.all.secure_redirects = 0\nnet.ipv4.conf.all.send_redirects = 0\nnet.ipv4.conf.default.accept_redirects = 0\nnet.ipv4.conf.default.accept_source_route = 0\nnet.ipv4.conf.default.log_martians = 1\nnet.ipv4.conf.default.rp_filter = 1\nnet.ipv4.conf.default.secure_redirects = 0\nnet.ipv4.conf.default.send_redirects = 0\nnet.ipv4.icmp_echo_ignore_broadcasts = 1\nnet.ipv4.icmp_ignore_bogus_error_responses = 1\nnet.ipv4.ip_forward = 0\nnet.ipv4.tcp_rfc1337 = 1\nnet.ipv4.tcp_syncookies = 1\nnet.ipv6.conf.all.accept_ra = 0\nnet.ipv6.conf.all.accept_redirects = 0\nnet.ipv6.conf.default.accept_ra = 0\nnet.ipv6.conf.default.accept_redirects = 0\nEOF\nchmod 644 /etc/sysctl.d/99-cis-hardening.conf'",
        "sysctl --system"
      ],
      "files": [
        "/etc/sysctl.d/99-cis-hardening.conf"
      ]
    },
    {
      "id": "CRYPTO-1",
      "title": "Ensure system crypto policy is not LEGACY",
      "changed": false,
      "ok": true,
      "notes": "current: DEFAULT",
      "commands": [
        "update-crypto-policies --show",
        "update-crypto-policies --set DEFAULT"
      ],
      "files": null
    },
    {
      "id": "BANNER-1",
      "title": "Set login banners and clear /etc/motd",
      "changed": true,
      "ok": true,
      "notes": "Wrote /etc/issue; Wrote /etc/issue.net; No change",
      "commands": null,
      "files": [
        "/etc/issue",
        "/etc/issue.net",
        "/etc/motd"
      ]
    },
    {
      "id": "SSH-1",
      "title": "Harden SSH daemon configuration",
      "changed": true,
      "ok": true,
      "notes": "",
      "commands": [
        "bash -lc 'mkdir -p /etc/ssh/sshd_config.d && cat > /etc/ssh/sshd_config.d/99-cis-hardening.conf <<'\"'\"'EOF'\"'\"'\n# Generated by cis hardening scripts\nPermitRootLogin no\nPasswordAuthentication no\nX11Forwarding no\nMaxAuthTries 4\nLoginGraceTime 60\nClientAliveInterval 300\nClientAliveCountMax 0\nAllowTcpForwarding no\nAllowAgentForwarding no\nUsePAM yes\nPermitEmptyPasswords no\nIgnoreRhosts yes\nHostbasedAuthentication no\nPermitUserEnvironment no\nLogLevel INFO\nEOF\nchmod 600 /etc/ssh/sshd_config.d/99-cis-hardening.conf'",
        "sshd -t",
        "systemctl restart sshd"
      ],
      "files": [
        "/etc/ssh/sshd_config.d/99-cis-hardening.conf"
      ]
    },
    {
      "id": "SUDO-1",
      "title": "Configure sudo to use pty and log to /var/log/sudo.log",
      "changed": true,
      "ok": true,
      "notes": "Wrote /etc/sudoers.d/99-cis-hardening",
      "commands": null,
      "files": [
        "/etc/sudoers.d/99-cis-hardening"
      ]
    },
    {
      "id": "SVC-avahi-daemon",
      "title": "Disable service: avahi-daemon",
      "changed": true,
      "ok": true,
      "notes": "Unit avahi-daemon.service does not exist, proceeding anyway.\nCreated symlink /etc/systemd/system/avahi-daemon.service \u2192 /dev/null.",
      "commands": [
        "systemctl mask --now avahi-daemon"
      ],
      "files": null
    },
    {
      "id": "SVC-cups",
      "title": "Disable service: cups",
      "changed": true,
      "ok": true,
      "notes": "Unit cups.service does not exist, proceeding anyway.\nCreated symlink /etc/systemd/system/cups.service \u2192 /dev/null.",
      "commands": [
        "systemctl mask --now cups"
      ],
      "files": null
    },
    {
      "id": "SVC-dhcpd",
      "title": "Disable service: dhcpd",
      "changed": true,
      "ok": true,
      "notes": "Unit dhcpd.service does not exist, proceeding anyway.\nCreated symlink /etc/systemd/system/dhcpd.service \u2192 /dev/null.",
      "commands": [
        "systemctl mask --now dhcpd"
      ],
      "files": null
    },
    {
      "id": "SVC-slapd",
      "title": "Disable service: slapd",
      "changed": true,
      "ok": true,
      "notes": "Unit slapd.service does not exist, proceeding anyway.\nCreated symlink /etc/systemd/system/slapd.service \u2192 /dev/null.",
      "commands": [
        "systemctl mask --now slapd"
      ],
      "files": null
    },
    {
      "id": "SVC-nfs-server",
      "title": "Disable service: nfs-server",
      "changed": true,
      "ok": true,
      "notes": "Unit nfs-server.service does not exist, proceeding anyway.\nCreated symlink /etc/systemd/system/nfs-server.service \u2192 /dev/null.",
      "commands": [
        "systemctl mask --now nfs-server"
      ],
      "files": null
    },
    {
      "id": "SVC-rpcbind",
      "title": "Disable service: rpcbind",
      "changed": true,
      "ok": true,
      "notes": "Unit rpcbind.service does not exist, proceeding anyway.\nCreated symlink /etc/systemd/system/rpcbind.service \u2192 /dev/null.",
      "commands": [
        "systemctl mask --now rpcbind"
      ],
      "files": null
    },
    {
      "id": "SVC-smb",
      "title": "Disable service: smb",
      "changed": true,
      "ok": true,
      "notes": "Unit smb.service does not exist, proceeding anyway.\nCreated symlink /etc/systemd/system/smb.service \u2192 /dev/null.",
      "commands": [
        "systemctl mask --now smb"
      ],
      "files": null
    },
    {
      "id": "SVC-snmpd",
      "title": "Disable service: snmpd",
      "changed": true,
      "ok": true,
      "notes": "Unit snmpd.service does not exist, proceeding anyway.\nCreated symlink /etc/systemd/system/snmpd.service \u2192 /dev/null.",
      "commands": [
        "systemctl mask --now snmpd"
      ],
      "files": null
    },
    {
      "id": "SVC-rsyncd",
      "title": "Disable service: rsyncd",
      "changed": true,
      "ok": true,
      "notes": "Unit rsyncd.service does not exist, proceeding anyway.\nCreated symlink /etc/systemd/system/rsyncd.service \u2192 /dev/null.",
      "commands": [
        "systemctl mask --now rsyncd"
      ],
      "files": null
    },
    {
      "id": "SVC-ypserv",
      "title": "Disable service: ypserv",
      "changed": true,
      "ok": true,
      "notes": "Unit ypserv.service does not exist, proceeding anyway.\nCreated symlink /etc/systemd/system/ypserv.service \u2192 /dev/null.",
      "commands": [
        "systemctl mask --now ypserv"
      ],
      "files": null
    },
    {
      "id": "SVC-telnet.socket",
      "title": "Disable service: telnet.socket",
      "changed": true,
      "ok": true,
      "notes": "Unit telnet.socket does not exist, proceeding anyway.\nCreated symlink /etc/systemd/system/telnet.socket \u2192 /dev/null.",
      "commands": [
        "systemctl mask --now telnet.socket"
      ],
      "files": null
    },
    {
      "id": "SVC-tftp.socket",
      "title": "Disable service: tftp.socket",
      "changed": true,
      "ok": true,
      "notes": "Unit tftp.socket does not exist, proceeding anyway.\nCreated symlink /etc/systemd/system/tftp.socket \u2192 /dev/null.",
      "commands": [
        "systemctl mask --now tftp.socket"
      ],
      "files": null
    },
    {
      "id": "PKG-1",
      "title": "Remove legacy/insecure network packages",
      "changed": true,
      "ok": true,
      "notes": "No match for argument: telnet\nNo match for argument: telnet-server\nNo match for argument: ftp\nNo match for argument: tftp\nNo match for argument: tftp-server\nNo match for argument: rsh\nNo match for argument: rsh-server\nNo match for argument: ypbind\nNo match for argument: ypserv\nNo match for argument: talk\nNo match for argument: talk-server\nNo match for argument: xinetd\nDependencies resolved.\nNothing to do.\nComplete!\nNo packages marked for removal.",
      "commands": [
        "dnf -y remove telnet telnet-server ftp tftp tftp-server rsh rsh-server ypbind ypserv talk talk-server xinetd"
      ],
      "files": null
    },
    {
      "id": "AUD-1",
      "title": "Install auditd",
      "changed": true,
      "ok": true,
      "notes": "Last metadata expiration check: 0:30:57 ago on Tue 16 Dec 2025 01:51:45 PM CST.\nPackage audit-3.1.2-2.el9.x86_64 is already installed.\nPackage audit-libs-3.1.2-2.el9.x86_64 is already installed.\nDependencies resolved.\n================================================================================\n Package           Arch       Version               Repository             Size\n================================================================================\nUpgrading:\n audit             x86_64     3.1.5-7.0.1.el9       ol9_baseos_latest     331 k\n audit-libs        x86_64     3.1.5-7.0.1.el9       ol9_baseos_latest     127 k\n python3-audit     x86_64     3.1.5-7.0.1.el9       ol9_appstream          88 k\n\nTransaction Summary\n================================================================================\nUpgrade  3 Packages\n\nTotal download size: 546 k\nDownloading Packages:\n(1/3): python3-audit-3.1.5-7.0.1.el9.x86_64.rpm  93 kB/s |  88 kB     00:00    \n(2/3): audit-libs-3.1.5-7.0.1.el9.x86_64.rpm    132 kB/s | 127 kB     00:00    \n(3/3): audit-3.1.5-7.0.1.el9.x86_64.rpm         244 kB/s | 331 kB     00:01    \n--------------------------------------------------------------------------------\nTotal                                           400 kB/s | 546 kB     00:01     \nRunning transaction check\nTransaction check succeeded.\nRunning transaction test\nTransaction test succeeded.\nRunning transaction\n  Preparing        :                                                        1/1 \n  Upgrading        : audit-libs-3.1.5-7.0.1.el9.x86_64                      1/6 \n  Upgrading        : audit-3.1.5-7.0.1.el9.x86_64                           2/6 \n  Running scriptlet: audit-3.1.5-7.0.1.el9.x86_64                           2/6 \nWarning: The unit file, source configuration file or drop-ins of auditd.service changed on disk. Run 'systemctl daemon-reload' to reload units.\nWarning: The unit file, source configuration file or drop-ins of auditd.service changed on disk. Run 'systemctl daemon-reload' to reload units.\n\n  Upgrading        : python3-audit-3.1.5-7.0.1.el9.x86_64                   3/6 \n  Cleanup          : python3-audit-3.1.2-2.el9.x86_64                       4/6 \n  Running scriptlet: audit-3.1.2-2.el9.x86_64                               5/6 \n  Cleanup          : audit-3.1.2-2.el9.x86_64                               5/6 \n  Running scriptlet: audit-3.1.2-2.el9.x86_64                               5/6 \n  Cleanup          : audit-libs-3.1.2-2.el9.x86_64                          6/6 \n  Running scriptlet: audit-libs-3.1.2-2.el9.x86_64                          6/6 \n  Verifying        : audit-3.1.5-7.0.1.el9.x86_64                           1/6 \n  Verifying        : audit-3.1.2-2.el9.x86_64                               2/6 \n  Verifying        : audit-libs-3.1.5-7.0.1.el9.x86_64                      3/6 \n  Verifying        : audit-libs-3.1.2-2.el9.x86_64                          4/6 \n  Verifying        : python3-audit-3.1.5-7.0.1.el9.x86_64                   5/6 \n  Verifying        : python3-audit-3.1.2-2.el9.x86_64                       6/6 \n\nUpgraded:\n  audit-3.1.5-7.0.1.el9.x86_64             audit-libs-3.1.5-7.0.1.el9.x86_64    \n  python3-audit-3.1.5-7.0.1.el9.x86_64    \n\nComplete!",
      "commands": [
        "dnf -y install audit audit-libs"
      ],
      "files": null
    },
    {
      "id": "AUD-2",
      "title": "Enable auditd",
      "changed": true,
      "ok": true,
      "notes": "",
      "commands": [
        "systemctl enable --now auditd"
      ],
      "files": null
    },
    {
      "id": "AUD-3",
      "title": "Install CIS audit rules and load",
      "changed": true,
      "ok": true,
      "notes": "Wrote /etc/audit/rules.d/99-cis-hardening.rules\nNo rules\nenabled 1\nfailure 1\npid 33089\nrate_limit 0\nbacklog_limit 8192\nlost 0\nbacklog 0\nbacklog_wait_time 60000\nbacklog_wait_time_actual 0\nenabled 1\nfailure 1\npid 33089\nrate_limit 0\nbacklog_limit 8192\nlost 0\nbacklog 4\nbacklog_wait_time 60000\nbacklog_wait_time_actual 0\nenabled 1\nfailure 1\npid 33089\nrate_limit 0\nbacklog_limit 8192\nlost 0\nbacklog 0\nbacklog_wait_time 60000\nbacklog_wait_time_actual 0\nenabled 2\nfailure 1\npid 33089\nrate_limit 0\nbacklog_limit 8192\nlost 0\nbacklog 0\nbacklog_wait_time 60000\nbacklog_wait_time_actual 0\nOld style watch rules are slower\nOld style watch rules are slower\nOld style watch rules are slower\nOld style watch rules are slower\nOld style watch rules are slower\nOld style watch rules are slower\nOld style watch rules are slower",
      "commands": [
        "augenrules --load"
      ],
      "files": [
        "/etc/audit/rules.d/99-cis-hardening.rules"
      ]
    },
    {
      "id": "LOG-1",
      "title": "Harden journald persistence/limits",
      "changed": true,
      "ok": true,
      "notes": "Updated /etc/systemd/journald.conf: Storage; Updated /etc/systemd/journald.conf: Compress; Updated /etc/systemd/journald.conf: SystemMaxUse",
      "commands": null,
      "files": [
        "/etc/systemd/journald.conf"
      ]
    },
    {
      "id": "LOG-2",
      "title": "Install rsyslog",
      "changed": true,
      "ok": true,
      "notes": "Last metadata expiration check: 0:31:05 ago on Tue 16 Dec 2025 01:51:45 PM CST.\nPackage rsyslog-8.2310.0-4.el9.x86_64 is already installed.\nDependencies resolved.\n================================================================================\n Package              Arch      Version                  Repository        Size\n================================================================================\nUpgrading:\n rsyslog              x86_64    8.2506.0-2.0.1.el9       ol9_appstream    844 k\n rsyslog-gnutls       x86_64    8.2506.0-2.0.1.el9       ol9_appstream     27 k\n rsyslog-gssapi       x86_64    8.2506.0-2.0.1.el9       ol9_appstream     28 k\n rsyslog-logrotate    x86_64    8.2506.0-2.0.1.el9       ol9_appstream    8.5 k\n rsyslog-relp         x86_64    8.2506.0-2.0.1.el9       ol9_appstream     28 k\n\nTransaction Summary\n================================================================================\nUpgrade  5 Packages\n\nTotal download size: 935 k\nDownloading Packages:\n(1/5): rsyslog-gnutls-8.2506.0-2.0.1.el9.x86_64  37 kB/s |  27 kB     00:00    \n(2/5): rsyslog-gssapi-8.2506.0-2.0.1.el9.x86_64  35 kB/s |  28 kB     00:00    \n(3/5): rsyslog-logrotate-8.2506.0-2.0.1.el9.x86  55 kB/s | 8.5 kB     00:00    \n(4/5): rsyslog-relp-8.2506.0-2.0.1.el9.x86_64.r 161 kB/s |  28 kB     00:00    \n(5/5): rsyslog-8.2506.0-2.0.1.el9.x86_64.rpm    613 kB/s | 844 kB     00:01    \n--------------------------------------------------------------------------------\nTotal                                           668 kB/s | 935 kB     00:01     \nRunning transaction check\nTransaction check succeeded.\nRunning transaction test\nTransaction test succeeded.\nRunning transaction\n  Preparing        :                                                        1/1 \n  Upgrading        : rsyslog-logrotate-8.2506.0-2.0.1.el9.x86_64           1/10 \n  Upgrading        : rsyslog-8.2506.0-2.0.1.el9.x86_64                     2/10 \n  Running scriptlet: rsyslog-8.2506.0-2.0.1.el9.x86_64                     2/10 \n  Upgrading        : rsyslog-gnutls-8.2506.0-2.0.1.el9.x86_64              3/10 \n  Upgrading        : rsyslog-gssapi-8.2506.0-2.0.1.el9.x86_64              4/10 \n  Upgrading        : rsyslog-relp-8.2506.0-2.0.1.el9.x86_64                5/10 \n  Cleanup          : rsyslog-relp-8.2310.0-4.el9.x86_64                    6/10 \n  Cleanup          : rsyslog-gssapi-8.2310.0-4.el9.x86_64                  7/10 \n  Cleanup          : rsyslog-gnutls-8.2310.0-4.el9.x86_64                  8/10 \n  Running scriptlet: rsyslog-8.2310.0-4.el9.x86_64                         9/10 \n  Cleanup          : rsyslog-8.2310.0-4.el9.x86_64                         9/10 \n  Running scriptlet: rsyslog-8.2310.0-4.el9.x86_64                         9/10 \n  Cleanup          : rsyslog-logrotate-8.2310.0-4.el9.x86_64              10/10 \n  Running scriptlet: rsyslog-logrotate-8.2310.0-4.el9.x86_64              10/10 \n  Verifying        : rsyslog-8.2506.0-2.0.1.el9.x86_64                     1/10 \n  Verifying        : rsyslog-8.2310.0-4.el9.x86_64                         2/10 \n  Verifying        : rsyslog-gnutls-8.2506.0-2.0.1.el9.x86_64              3/10 \n  Verifying        : rsyslog-gnutls-8.2310.0-4.el9.x86_64                  4/10 \n  Verifying        : rsyslog-gssapi-8.2506.0-2.0.1.el9.x86_64              5/10 \n  Verifying        : rsyslog-gssapi-8.2310.0-4.el9.x86_64                  6/10 \n  Verifying        : rsyslog-logrotate-8.2506.0-2.0.1.el9.x86_64           7/10 \n  Verifying        : rsyslog-logrotate-8.2310.0-4.el9.x86_64               8/10 \n  Verifying        : rsyslog-relp-8.2506.0-2.0.1.el9.x86_64                9/10 \n  Verifying        : rsyslog-relp-8.2310.0-4.el9.x86_64                   10/10 \n\nUpgraded:\n  rsyslog-8.2506.0-2.0.1.el9.x86_64                                             \n  rsyslog-gnutls-8.2506.0-2.0.1.el9.x86_64                                      \n  rsyslog-gssapi-8.2506.0-2.0.1.el9.x86_64                                      \n  rsyslog-logrotate-8.2506.0-2.0.1.el9.x86_64                                   \n  rsyslog-relp-8.2506.0-2.0.1.el9.x86_64                                        \n\nComplete!",
      "commands": [
        "dnf -y install rsyslog"
      ],
      "files": null
    },
    {
      "id": "LOG-3",
      "title": "Enable rsyslog",
      "changed": true,
      "ok": true,
      "notes": "",
      "commands": [
        "systemctl enable --now rsyslog"
      ],
      "files": null
    },
    {
      "id": "PERM-1",
      "title": "Harden key system file permissions",
      "changed": false,
      "ok": true,
      "notes": "/etc/passwd: No change; /etc/group: No change; /etc/shadow: No change; /etc/gshadow: No change; /etc/ssh/sshd_config: No change",
      "commands": null,
      "files": null
    },
    {
      "id": "FW-1",
      "title": "Install firewalld",
      "changed": true,
      "ok": true,
      "notes": "Last metadata expiration check: 0:31:13 ago on Tue 16 Dec 2025 01:51:45 PM CST.\nPackage firewalld-1.3.4-1.0.1.el9.noarch is already installed.\nDependencies resolved.\n================================================================================\n Package                Arch     Version              Repository           Size\n================================================================================\nUpgrading:\n firewalld              noarch   1.3.4-15.0.1.el9_6   ol9_baseos_latest   838 k\n firewalld-filesystem   noarch   1.3.4-15.0.1.el9_6   ol9_baseos_latest   9.1 k\n python3-firewall       noarch   1.3.4-15.0.1.el9_6   ol9_baseos_latest   539 k\n\nTransaction Summary\n================================================================================\nUpgrade  3 Packages\n\nTotal download size: 1.4 M\nDownloading Packages:\n(1/3): firewalld-filesystem-1.3.4-15.0.1.el9_6.  15 kB/s | 9.1 kB     00:00    \n(2/3): firewalld-1.3.4-15.0.1.el9_6.noarch.rpm  670 kB/s | 838 kB     00:01    \n(3/3): python3-firewall-1.3.4-15.0.1.el9_6.noar 429 kB/s | 539 kB     00:01    \n--------------------------------------------------------------------------------\nTotal                                           1.1 MB/s | 1.4 MB     00:01     \nRunning transaction check\nTransaction check succeeded.\nRunning transaction test\nTransaction test succeeded.\nRunning transaction\n  Running scriptlet: firewalld-1.3.4-15.0.1.el9_6.noarch                    1/1 \n  Preparing        :                                                        1/1 \n  Upgrading        : python3-firewall-1.3.4-15.0.1.el9_6.noarch             1/6 \n  Upgrading        : firewalld-filesystem-1.3.4-15.0.1.el9_6.noarch         2/6 \n  Upgrading        : firewalld-1.3.4-15.0.1.el9_6.noarch                    3/6 \n  Running scriptlet: firewalld-1.3.4-15.0.1.el9_6.noarch                    3/6 \n  Running scriptlet: firewalld-1.3.4-1.0.1.el9.noarch                       4/6 \n  Cleanup          : firewalld-1.3.4-1.0.1.el9.noarch                       4/6 \n  Running scriptlet: firewalld-1.3.4-1.0.1.el9.noarch                       4/6 \n  Cleanup          : firewalld-filesystem-1.3.4-1.0.1.el9.noarch            5/6 \n  Cleanup          : python3-firewall-1.3.4-1.0.1.el9.noarch                6/6 \n  Running scriptlet: python3-firewall-1.3.4-1.0.1.el9.noarch                6/6 \n  Verifying        : firewalld-1.3.4-15.0.1.el9_6.noarch                    1/6 \n  Verifying        : firewalld-1.3.4-1.0.1.el9.noarch                       2/6 \n  Verifying        : firewalld-filesystem-1.3.4-15.0.1.el9_6.noarch         3/6 \n  Verifying        : firewalld-filesystem-1.3.4-1.0.1.el9.noarch            4/6 \n  Verifying        : python3-firewall-1.3.4-15.0.1.el9_6.noarch             5/6 \n  Verifying        : python3-firewall-1.3.4-1.0.1.el9.noarch                6/6 \n\nUpgraded:\n  firewalld-1.3.4-15.0.1.el9_6.noarch                                           \n  firewalld-filesystem-1.3.4-15.0.1.el9_6.noarch                                \n  python3-firewall-1.3.4-15.0.1.el9_6.noarch                                    \n\nComplete!",
      "commands": [
        "dnf -y install firewalld"
      ],
      "files": null
    },
    {
      "id": "FW-2",
      "title": "Enable firewalld",
      "changed": true,
      "ok": true,
      "notes": "Created symlink /etc/systemd/system/dbus-org.fedoraproject.FirewallD1.service \u2192 /usr/lib/systemd/system/firewalld.service.\nCreated symlink /etc/systemd/system/multi-user.target.wants/firewalld.service \u2192 /usr/lib/systemd/system/firewalld.service.",
      "commands": [
        "systemctl enable --now firewalld"
      ],
      "files": null
    },
    {
      "id": "FW-3",
      "title": "Configure firewalld",
      "changed": true,
      "ok": true,
      "notes": "success\nWarning: ZONE_ALREADY_SET: public\nsuccess\nsuccess\nsuccess\nsuccess\nsuccess\nsuccess",
      "commands": [
        "firewall-cmd --set-default-zone public",
        "bash -lc 'set -e\nZONE=public\nSVCS=\"$(firewall-cmd --zone=\"$ZONE\" --list-services || true)\"\nPORTS=\"$(firewall-cmd --zone=\"$ZONE\" --list-ports || true)\"\nfor s in $SVCS; do firewall-cmd --permanent --zone=\"$ZONE\" --remove-service=\"$s\" || true; done\nfor p in $PORTS; do firewall-cmd --permanent --zone=\"$ZONE\" --remove-port=\"$p\" || true; done\nfirewall-cmd --permanent --zone=\"$ZONE\" --add-service=ssh\nfirewall-cmd --permanent --zone=\"$ZONE\" --add-service=https\nfirewall-cmd --reload'"
      ],
      "files": null
    },
    {
      "id": "SEL-1",
      "title": "Ensure SELinux is enforcing",
      "changed": true,
      "ok": true,
      "notes": "Enforcing",
      "commands": [
        "getenforce",
        "bash -lc 'sed -ri '\"'\"'s/^SELINUX=.*/SELINUX=enforcing/'\"'\"' /etc/selinux/config'",
        "setenforce 1"
      ],
      "files": [
        "/etc/selinux/config"
      ]
    },
    {
      "id": "AUTH-1",
      "title": "Configure password quality (pwquality.conf)",
      "changed": true,
      "ok": true,
      "notes": "Updated /etc/security/pwquality.conf: minlen; Updated /etc/security/pwquality.conf: minclass; Updated /etc/security/pwquality.conf: dcredit; Updated /etc/security/pwquality.conf: ucredit; Updated /etc/security/pwquality.conf: lcredit; Updated /etc/security/pwquality.conf: ocredit",
      "commands": null,
      "files": [
        "/etc/security/pwquality.conf"
      ]
    },
    {
      "id": "AUTH-2",
      "title": "Configure password aging (login.defs)",
      "changed": true,
      "ok": true,
      "notes": "Updated /etc/login.defs: PASS_MAX_DAYS; Updated /etc/login.defs: PASS_MIN_DAYS; Updated /etc/login.defs: PASS_WARN_AGE",
      "commands": null,
      "files": [
        "/etc/login.defs"
      ]
    },
    {
      "id": "AUTH-3",
      "title": "Set default umask",
      "changed": true,
      "ok": true,
      "notes": "",
      "commands": [
        "bash -lc 'cat > /etc/profile.d/99-cis-umask.sh <<'\"'\"'EOF'\"'\"'\numask 027\nEOF\nchmod 644 /etc/profile.d/99-cis-umask.sh'"
      ],
      "files": [
        "/etc/profile.d/99-cis-umask.sh"
      ]
    },
    {
      "id": "AUTH-4",
      "title": "Enable/configure account lockout (faillock)",
      "changed": true,
      "ok": true,
      "notes": "Make sure that SSSD service is configured and enabled. See SSSD documentation for more information.\n\nChanges were successfully applied.; Updated /etc/security/faillock.conf: deny; Updated /etc/security/faillock.conf: fail_interval; Updated /etc/security/faillock.conf: unlock_time",
      "commands": [
        "bash -lc 'authselect current >/dev/null 2>&1 && authselect enable-feature with-faillock && authselect apply-changes || true'"
      ],
      "files": [
        "/etc/security/faillock.conf"
      ]
    },
    {
      "id": "CORE-1",
      "title": "Disable core dumps",
      "changed": true,
      "ok": true,
      "notes": "; Updated /etc/sysctl.d/99-cis-hardening.conf: fs.suid_dumpable",
      "commands": [
        "bash -lc 'cat > /etc/security/limits.d/99-cis-coredumps.conf <<'\"'\"'EOF'\"'\"'\n* hard core 0\nEOF\nchmod 644 /etc/security/limits.d/99-cis-coredumps.conf'"
      ],
      "files": [
        "/etc/security/limits.d/99-cis-coredumps.conf"
      ]
    },
    {
      "id": "CRON-1",
      "title": "Enable cron daemon",
      "changed": true,
      "ok": true,
      "notes": "",
      "commands": [
        "systemctl enable --now crond"
      ],
      "files": null
    },
    {
      "id": "CRON-2",
      "title": "Restrict cron/at to authorized users",
      "changed": true,
      "ok": true,
      "notes": "Wrote /etc/cron.allow; Wrote /etc/at.allow",
      "commands": null,
      "files": [
        "/etc/cron.allow",
        "/etc/at.allow"
      ]
    },
    {
      "id": "CRON-3",
      "title": "Harden cron permissions",
      "changed": true,
      "ok": true,
      "notes": "/etc/crontab: Set /etc/crontab mode 0o644->0o600; /etc/cron.hourly: Set /etc/cron.hourly mode 0o755->0o700; /etc/cron.daily: Set /etc/cron.daily mode 0o755->0o700; /etc/cron.weekly: Set /etc/cron.weekly mode 0o755->0o700; /etc/cron.monthly: Set /etc/cron.monthly mode 0o755->0o700; /etc/cron.d: Set /etc/cron.d mode 0o755->0o700",
      "commands": null,
      "files": null
    },
    {
      "id": "AIDE-1",
      "title": "Install AIDE",
      "changed": true,
      "ok": true,
      "notes": "Last metadata expiration check: 0:31:27 ago on Tue 16 Dec 2025 01:51:45 PM CST.\nDependencies resolved.\n================================================================================\n Package      Architecture   Version                Repository             Size\n================================================================================\nInstalling:\n aide         x86_64         0.16-105.el9           ol9_appstream         167 k\n\nTransaction Summary\n================================================================================\nInstall  1 Package\n\nTotal download size: 167 k\nInstalled size: 353 k\nDownloading Packages:\naide-0.16-105.el9.x86_64.rpm                    171 kB/s | 167 kB     00:00    \n--------------------------------------------------------------------------------\nTotal                                           171 kB/s | 167 kB     00:00     \nRunning transaction check\nTransaction check succeeded.\nRunning transaction test\nTransaction test succeeded.\nRunning transaction\n  Preparing        :                                                        1/1 \n  Installing       : aide-0.16-105.el9.x86_64                               1/1 \n  Running scriptlet: aide-0.16-105.el9.x86_64                               1/1 \n  Verifying        : aide-0.16-105.el9.x86_64                               1/1 \n\nInstalled:\n  aide-0.16-105.el9.x86_64                                                      \n\nComplete!",
      "commands": [
        "dnf -y install aide"
      ],
      "files": null
    },
    {
      "id": "AIDE-2",
      "title": "AIDE initialization (skipped by config)",
      "changed": false,
      "ok": true,
      "notes": "Set aide.initialize_if_missing=true to initialize",
      "commands": null,
      "files": null
    },
    {
      "id": "MNT-1",
      "title": "Configure tmpfs mounts for /tmp and /var/tmp",
      "changed": true,
      "ok": true,
      "notes": "Created symlink /etc/systemd/system/local-fs.target.wants/tmp.mount \u2192 /etc/systemd/system/tmp.mount.\nCreated symlink /etc/systemd/system/local-fs.target.wants/var-tmp.mount \u2192 /etc/systemd/system/var-tmp.mount.",
      "commands": [
        "bash -lc 'cat > /etc/systemd/system/tmp.mount <<'\"'\"'EOF'\"'\"'\n[Unit]\nDescription=Temporary Directory (/tmp)\nBefore=local-fs.target\n\n[Mount]\nWhat=tmpfs\nWhere=/tmp\nType=tmpfs\nOptions=mode=1777,strictatime,nodev,nosuid,noexec,size=1G\n\n[Install]\nWantedBy=local-fs.target\nEOF\ncat > /etc/systemd/system/var-tmp.mount <<'\"'\"'EOF'\"'\"'\n[Unit]\nDescription=Temporary Directory (/var/tmp)\nBefore=local-fs.target\n\n[Mount]\nWhat=tmpfs\nWhere=/var/tmp\nType=tmpfs\nOptions=mode=1777,strictatime,nodev,nosuid,noexec,size=1G\n\n[Install]\nWantedBy=local-fs.target\nEOF\nsystemctl daemon-reload\nsystemctl enable --now tmp.mount var-tmp.mount'"
      ],
      "files": [
        "/etc/systemd/system/tmp.mount",
        "/etc/systemd/system/var-tmp.mount"
      ]
    },
    {
      "id": "IPV6-0",
      "title": "Disable IPv6 (skipped by config)",
      "changed": false,
      "ok": true,
      "notes": "ipv6.disable=false",
      "commands": null,
      "files": null
    }
  ],
  "ok": true
}
